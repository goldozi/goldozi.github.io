document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("mobileToggle"),t=document.getElementById("mobileMenu"),n=document.getElementById("mobileMenuClose"),r=document.getElementById("overlay"),o=document.body;function a(){t.classList.remove("active"),r.classList.remove("active"),e.innerHTML='<i class="fas fa-bars"></i>',e.style.color="",o.style.overflow="auto"}e.addEventListener("click",(function(){t.classList.contains("active")?a():(t.classList.add("active"),r.classList.add("active"),e.innerHTML='<i class="fas fa-times"></i>',e.style.color="var(--accent-color)",o.style.overflow="hidden")})),n.addEventListener("click",a),r.addEventListener("click",a);document.querySelectorAll(".mobile-menu-content a").forEach((e=>{e.addEventListener("click",a)}))}));const stories={1:[{type:"image",url:"logo-hero.jpg"},{type:"video",url:"1.mp4"},{type:"image",url:"logo-hero.jpg"}],2:[{type:"image",url:"logo-hero.jpg"},{type:"video",url:"1.mp4"},{type:"image",url:"logo-hero.jpg"}],3:[{type:"image",url:"logo-hero.jpg"},{type:"video",url:"1.mp4"},{type:"image",url:"logo-hero.jpg"}],4:[{type:"image",url:"logo-hero.jpg"},{type:"video",url:"1.mp4"},{type:"image",url:"logo-hero.jpg"}]};let storyInterval,progressInterval,currentStory=null,currentStoryIndex=0,mediaElements=[];function openStory(){if(!stories[currentStory]||0===stories[currentStory].length)return;const e=document.querySelector(".story-viewer"),t=document.querySelector(".media-container");document.querySelector(".progress-bars");t.innerHTML="",mediaElements=[],stories[currentStory].forEach(((e,n)=>{let r;"image"===e.type?(r=document.createElement("img"),r.className="story-image",r.src=e.url,r.alt=`Story ${n+1}`):"video"===e.type&&(r=document.createElement("video"),r.className="story-video",r.src=e.url,r.playsInline=!0,r.muted=!1,r.loop=!1,r.addEventListener("ended",(()=>navigateStory("next"))),r.addEventListener("loadedmetadata",updateVideoDuration)),t.appendChild(r),mediaElements.push(r)})),createProgressBars(),updateStory(),e.style.display="flex",startStoryTimer()}function createProgressBars(){const e=document.querySelector(".progress-bars");e.innerHTML="",stories[currentStory].forEach((()=>{const t=document.createElement("div");t.className="progress-bar";const n=document.createElement("div");n.className="progress",t.appendChild(n),e.appendChild(t)}))}function updateVideoDuration(){"VIDEO"===mediaElements[currentStoryIndex].tagName&&mediaElements[currentStoryIndex].classList.contains("active-media")&&(clearInterval(storyInterval),clearInterval(progressInterval),startStoryTimer())}function updateStory(){mediaElements.forEach((e=>{e.classList.remove("active-media"),"VIDEO"===e.tagName&&(e.pause(),e.currentTime=0)}));const e=mediaElements[currentStoryIndex];e&&(e.classList.add("active-media"),"VIDEO"===e.tagName&&(e.muted=!1,e.play().catch((e=>{}))),resetProgressBars())}function resetProgressBars(){const e=document.querySelectorAll(".progress");e.length>0&&e.forEach(((e,t)=>{e.style.transition="none",e.style.width=t<currentStoryIndex?"100%":"0%",setTimeout((()=>{e.style.transition="width linear"}),10)}))}function startStoryTimer(){clearInterval(storyInterval),clearInterval(progressInterval);const e=mediaElements[currentStoryIndex];if(!e)return;let t=5e3;"VIDEO"===e.tagName&&(t=1e3*e.duration||5e3);const n=document.querySelectorAll(".progress");if(n.length<=currentStoryIndex)return;const r=n[currentStoryIndex];if(!r)return;let o=Date.now();progressInterval=setInterval((()=>{const e=Date.now()-o,n=Math.min(e/t*100,100);r.style.width=`${n}%`,n>=100&&clearInterval(progressInterval)}),50),storyInterval=setInterval((()=>{navigateStory("next")}),t)}function navigateStory(e){clearInterval(storyInterval),clearInterval(progressInterval),"next"===e?currentStoryIndex<stories[currentStory].length-1?(currentStoryIndex++,updateStory(),startStoryTimer()):closeStory():"prev"===e&&currentStoryIndex>0&&(currentStoryIndex--,updateStory(),startStoryTimer())}function closeStory(){clearInterval(storyInterval),clearInterval(progressInterval),mediaElements.forEach((e=>{"VIDEO"===e.tagName&&e.pause()})),document.querySelector(".story-viewer").style.display="none"}document.querySelectorAll(".story-item").forEach((e=>{e.addEventListener("click",(()=>{currentStory=e.getAttribute("data-story"),currentStoryIndex=0,openStory()}))})),document.querySelector(".close-btn").addEventListener("click",(()=>{currentStoryIndex<stories[currentStory].length-1?navigateStory("next"):closeStory()})),document.querySelector(".next").addEventListener("click",(()=>navigateStory("next"))),document.querySelector(".prev").addEventListener("click",(()=>navigateStory("prev")));let touchStartX=0,touchEndX=0;function handleSwipe(){const e=touchEndX-touchStartX;Math.abs(e)>50&&navigateStory(e>0?"prev":"next")}document.querySelector(".story-content").addEventListener("touchstart",(e=>{touchStartX=e.changedTouches[0].screenX}),!1),document.querySelector(".story-content").addEventListener("touchend",(e=>{touchEndX=e.changedTouches[0].screenX,handleSwipe()}),!1),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".tab-button");e.forEach((t=>{t.addEventListener("click",(function(){e.forEach((e=>e.classList.remove("active"))),this.classList.add("active"),document.querySelectorAll(".tab-content").forEach((e=>{e.classList.remove("active")}));const t=this.getAttribute("data-tab");document.getElementById(t).classList.add("active")}))}))}));const testimonials=[{id:1,name:"فاطمه احمدی",role:"هنرجوی دوره مقدماتی",avatar:"logo-hero.jpg",rating:5,text:"دوره‌های گلدوزی نفیسه واقعا عالی و کاربردی هستند. من بدون هیچ پیش‌زمینه‌ای در گلدوزی ثبت‌نام کردم و الان می‌تونم کارهای زیبایی خلق کنم."},{id:2,name:"زهرا رضایی",role:"هنرجوی دوره پیشرفته",avatar:"logo-hero.jpg",rating:5,text:"کیفیت آموزش‌ها و پشتیبانی استادان واقعا بی‌نظیره. هر سوالی داشتم با صبر و حوصله پاسخ داده شد و پیشرفتم محسوس بود."},{id:3,name:"مریم کریمی",role:"هنرجوی دوره تخصصی",avatar:"logo-hero.jpg",rating:4,text:"محتوای دوره‌ها بسیار غنی و کامل است. از پایه تا پیشرفته همه چیز آموزش داده شده و منابع اضافی هم در اختیارمون قرار گرفته."},{id:4,name:"نرگس محمدی",role:"هنرجوی دوره آنلاین",avatar:"logo-hero.jpg",rating:5,text:"به عنوان کسی که وقت کافی برای کلاس‌های حضوری ندارم، دوره‌های آنلاین نفیسه بهترین گزینه بود. فیلم‌ها با کیفیت بالا و قابل دانلود هستند."},{id:5,name:"سارا حسینی",role:"هنرجوی دوره طرح‌های سنتی",avatar:"logo-hero.jpg",rating:5,text:"آموزش طرح‌های سنتی ایرانی واقعا بی‌نظیر بود. استاد با جزئیات کامل همه مراحل رو آموزش دادن و نتیجه کار فوق‌العاده شد."},{id:6,name:"لیلا قاسمی",role:"هنرجوی دوره مدرن",avatar:"logo-hero.jpg",rating:4,text:"ترکیب هنر سنتی با تکنیک‌های مدرن ایده جالبی بود. من چندین اثر ترکیبی خلق کردم که مورد توجه همه قرار گرفت."}];let autoSlideInterval,currentSlide=0;const autoSlideDelay=5e3;function createTestimonialElements(){const e=document.getElementById("testimonialsTrack");e.innerHTML="",testimonials.forEach(((t,n)=>{const r=document.createElement("div");r.className="testimonial",r.dataset.index=n;let o="";for(let e=0;e<5;e++)e<t.rating?o+='<i class="fas fa-star"></i>':o+='<i class="far fa-star"></i>';const a=["#d4a5a5","#f4c2c2","#a56a6a","#8a4f4f","#c99797","#e6b8b8"],i=a[n%a.length];r.innerHTML=`\n            <div class="testimonial-header">\n                <div class="testimonial-avatar">\n                    <div style="width:100%; height:100%; background-color:${i}; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold;">\n                        ${t.name.split(" ")[0].charAt(0)}\n                    </div>\n                </div>\n                <div class="testimonial-info">\n                    <div class="testimonial-name">${t.name}</div>\n                    <div class="testimonial-role">${t.role}</div>\n                    <div class="testimonial-rating">${o}</div>\n                </div>\n            </div>\n            <div class="testimonial-text">${t.text}</div>\n        `,e.appendChild(r)}))}function updateTestimonialDisplay(){document.getElementById("testimonialsTrack");const e=document.querySelectorAll(".testimonial"),t=document.querySelector(".testimonials-container").offsetWidth;let n=4;window.innerWidth<=1200&&window.innerWidth>992?n=3:window.innerWidth<=992&&window.innerWidth>768?n=2:window.innerWidth<=768&&(n=1);const r=t/n-30;e.forEach((e=>{e.style.flex=`0 0 ${r}px`})),goToSlide(currentSlide)}function goToSlide(e){const t=document.getElementById("testimonialsTrack"),n=document.querySelectorAll(".testimonial");let r=4;window.innerWidth<=1200&&window.innerWidth>992?r=3:window.innerWidth<=992&&window.innerWidth>768?r=2:window.innerWidth<=768&&(r=1),currentSlide=e<0?n.length-r:e>n.length-r?0:e;const o=n[0].offsetWidth+30,a=currentSlide*o;t.style.transform=`translateX(${a}px)`,resetAutoSlide()}function startAutoSlide(){autoSlideInterval=setInterval((()=>{const e=document.querySelectorAll(".testimonial");let t=4;window.innerWidth<=1200&&window.innerWidth>992?t=3:window.innerWidth<=992&&window.innerWidth>768?t=2:window.innerWidth<=768&&(t=1),currentSlide>=e.length-t?goToSlide(0):goToSlide(currentSlide+1)}),5e3)}function resetAutoSlide(){clearInterval(autoSlideInterval),startAutoSlide()}document.addEventListener("DOMContentLoaded",(()=>{createTestimonialElements(),updateTestimonialDisplay(),startAutoSlide(),document.getElementById("prevBtn").addEventListener("click",(()=>{goToSlide(currentSlide-1)})),document.getElementById("nextBtn").addEventListener("click",(()=>{goToSlide(currentSlide+1)})),window.addEventListener("resize",updateTestimonialDisplay)})),document.addEventListener("DOMContentLoaded",(()=>{const e=["logo-hero.jpg","logo-hero.jpg","logo-hero.jpg","logo-hero.jpg","logo-hero.jpg","logo-hero.jpg"];document.querySelectorAll(".gallery-item").forEach(((t,n)=>{const r=t.querySelector("img"),o=e[n]||"fallback.jpg";setTimeout((()=>{r.onload=()=>{t.classList.add("loaded")},r.onerror=()=>{t.classList.add("loaded")},r.src=o}),300+150*n)}))}));